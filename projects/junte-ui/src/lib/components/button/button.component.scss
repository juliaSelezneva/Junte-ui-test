@import "../../assets/styles/variables";

$button-corner: $corner-large !default;
$button-without-text-corner: $corner-small !default;

$outline-ghost: 'ghost';
$outline-transparent: 'transparent';

$button-schemes: (
  #{$scheme-primary}: (
    fill-color: $white-color,
    fill-background-color: $primary-color,
    fill-hover-background-color: $primary-dark-color,
    fill-badge-color: $primary-color,
    fill-badge-background-color: $white-color,

    ghost-color: $primary-color,
    ghost-border-color: $primary-color,
    ghost-hover-background-color: $primary-color,
    ghost-hover-color: $white-color,
    ghost-badge-color: $white-color,
    ghost-hover-badge-color: $primary-color,
    ghost-badge-background: $primary-color,
    ghost-hover-badge-background: $primary-background,

    transparent-color: $primary-color,
    transparent-hover-color: $primary-dark-color,
    transparent-badge-color: $white-color,
    transparent-badge-background: $primary-color,
    button-focus-shadow-color: $primary-color
  ),
  #{$scheme-secondary}: (
    fill-color: $gray-900-color,
    fill-background-color: $secondary-color,
    fill-hover-background-color: $blue-100-color,
    fill-badge-color: $secondary-color,
    fill-badge-background-color: $gray-900-color,

    ghost-color: $gray-900-color,
    ghost-border-color: $gray-900-color,
    ghost-hover-background-color: $gray-900-color,
    ghost-hover-color: $secondary-color,
    ghost-badge-color: $white-color,
    ghost-hover-badge-background: $secondary-color,
    ghost-hover-badge-color: $gray-900-color,
    ghost-badge-background: $gray-900-color,

    transparent-color: $primary-text-color,
    transparent-hover-color: $primary-text-dark-color,
    transparent-badge-color: $white-color,
    transparent-badge-background: $gray-900-color,
    button-focus-shadow-color: $gray-900-color
  ),
  #{$scheme-success}: (
    fill-color: $white-color,
    fill-background-color: $success-color,
    fill-hover-background-color: $green-dark-color,
    fill-badge-color: $success-color,
    fill-badge-background-color: $white-color,

    ghost-color: $success-color,
    ghost-border-color: $success-color,
    ghost-hover-background-color: $success-color,
    ghost-hover-color: $white-color,
    ghost-badge-color: $white-color,
    ghost-badge-background: $success-color,
    ghost-hover-badge-background: $primary-background,
    ghost-hover-badge-color: $success-color,

    transparent-color: $success-color,
    transparent-hover-color: $green-dark-color,
    transparent-badge-color: $white-color,
    transparent-badge-background: $success-color,
    button-focus-shadow-color: $success-color
  ),
  #{$scheme-fail}: (
    fill-color: $white-color,
    fill-background-color: $fail-color,
    fill-hover-background-color: $red-dark-color,
    fill-badge-color: $fail-color,
    fill-badge-background-color: $white-color,

    ghost-color: $fail-color,
    ghost-border-color: $fail-color,
    ghost-hover-background-color: $fail-color,
    ghost-hover-color: $white-color,
    ghost-badge-color: $white-color,
    ghost-badge-background: $fail-color,
    ghost-hover-badge-background: $primary-background,
    ghost-hover-badge-color: $fail-color,

    transparent-color: $fail-color,
    transparent-hover-color: $red-dark-color,
    transparent-badge-color: $white-color,
    transparent-badge-background: $fail-color,
    button-focus-shadow-color: $fail-color
  ),
)!default;

$button-sizes: (
  #{$size-tiny}: (
    padding: 0 20px,
    padding-without-text: 0 7px,
    font-size: 10px,
    height: 24px,
    badge-size: 18px,
    icon-size: 14px,
    spinner-size: 8px,
  ),
  #{$size-small}: (
    padding: 0 50px,
    padding-without-text: 0 10px,
    font-size: 12px,
    height: 30px,
    badge-size: 24px,
    icon-size: 16px,
    spinner-size: 12px,
  ),
  #{$size-normal}: (
    padding: 0 38px,
    padding-without-text: 0 13px,
    font-size: 14px,
    height: 38px,
    badge-size: 24px,
    icon-size: 18px,
    spinner-size: 16px,
  ),
  #{$size-large}: (
    padding: 0 36px,
    padding-without-text: 0 18px,
    font-size: 16px,
    height: 50px,
    badge-size: 24px,
    icon-size: 20px,
    spinner-size: 16px,
  ),
)!default;

@mixin fill($scheme) {
  button {
    color: #{map-get($scheme, fill-color)};
    background-color: #{map-get($scheme, fill-background-color)};
    &:hover, &:focus {
      background-color: #{map-get($scheme, fill-hover-background-color)};
    }
    &:focus {
      box-shadow: 0 1px 5px #{map-get($scheme, button-focus-shadow-color)};
    }
    [badge][child-host=#{$jnt-badge-host}] {
      sup {
        color: #{map-get($scheme, fill-badge-color)};
        background: #{map-get($scheme, fill-badge-background-color)} !important;
      }
    }
    [icon][child-host=#{$jnt-icon-host}] {
      fill: #{map-get($scheme, fill-color)};
    }
  }
}

@mixin ghost($scheme) {

  button {
    color: #{map-get($scheme, ghost-color)};
    background-color: transparent;
    border-color: #{map-get($scheme, ghost-border-color)};
    &:hover, &:focus {
      background-color: #{map-get($scheme, ghost-hover-background-color)};
      color: #{map-get($scheme, ghost-hover-color)};

      [badge][child-host=#{$jnt-badge-host}] > sup {
        background: #{map-get($scheme, ghost-hover-badge-background)} !important;
        color: #{map-get($scheme, ghost-hover-badge-color)} !important;
      }
      [icon][child-host=#{$jnt-icon-host}] {
        fill: #{map-get($scheme, ghost-hover-color)};
      }
    }
    [badge][child-host=#{$jnt-badge-host}] > sup {
      background: #{map-get($scheme, ghost-badge-background)} !important;
      color: #{map-get($scheme, ghost-badge-color)};
    }
    [icon][child-host=#{$jnt-icon-host}] {
      fill: #{map-get($scheme, ghost-color)};
    }
  }
}

@mixin transparent($scheme) {

  button {
    color: #{map-get($scheme, transparent-color)};
    background-color: transparent;
    border-color: transparent;
    &:hover, &:focus {
      color: #{map-get($scheme, transparent-hover-color)};
      [icon][child-host=#{$jnt-icon-host}] {
        fill: #{map-get($scheme, transparent-hover-color)};
      }
    }
    [badge][child-host=#{$jnt-badge-host}] > sup {
      background: #{map-get($scheme, transparent-badge-background)} !important;
      color: #{map-get($scheme, transparent-badge-color)};
    }
    [icon][child-host=#{$jnt-icon-host}] {
      fill: #{map-get($scheme, transparent-color)};
    }
  }
}

@mixin size($size) {
  button {
    padding: #{map-get($size, padding)};
    font-size: #{map-get($size, font-size)};
    height: #{map-get($size, height)};
  }
  [badge][child-host=#{$jnt-badge-host}] > sup {
    min-width: #{map-get($size, badge-size)};
    width: #{map-get($size, badge-size)};
    min-height: #{map-get($size, badge-size)};
    height: #{map-get($size, badge-size)};
    line-height: #{map-get($size, badge-size)};
    span {
      height: #{map-get($size, badge-size)};
    }
  }
  [icon][child-host=#{$jnt-icon-host}] {
    &[type='animated'], &[type='svg'] {
      width: #{map-get($size, icon-size)};
      height: #{map-get($size, icon-size)};
    }
  }
  [loading][child-host=#{$jnt-spinner-host}] {
    width: #{map-get($size, spinner-size)};
    min-width: #{map-get($size, spinner-size)};
    height: #{map-get($size, spinner-size)};
    min-height: #{map-get($size, spinner-size)};
  }
}

@mixin size-without-text($size) {
  button {
    padding: #{map-get($size, padding-without-text)};
    font-size: #{map-get($size, font-size)};
    min-height: #{map-get($size, min-height)};
  }
}

:host {
  display: inline-flex;
  position: relative;
  max-width: 100%;

  @each $scheme, $map in $button-schemes {
    &[scheme='#{$scheme}'] {
      @include fill($map);
      &[outline='#{$outline-ghost}'] {
        button {
          border: 1px solid transparent;
        }
        @include ghost($map);
      }
      &[outline='#{$outline-transparent}'] {
        @include transparent($map);
      }
    }
  }

  @each $size, $map in $button-sizes {
    &[size='#{$size}'] {
      @include size($map);
    }
  }

  &[loading='true'] {
    button {
      cursor: default;
    }
  }
  &[disabled='true'] {
    opacity: .65;
    pointer-events: none;
    button {
      cursor: default;
    }
  }
  &[width='fluid'] {
    width: 100%;
  }

  &[with-text="false"] {
    @each $size, $map in $button-sizes {
      &[size='#{$size}'] {
        @include size-without-text($map);
      }
    }
    button {
      border-radius: $button-without-text-corner;
      [icon] {
        margin-right: 0;
      }
    }
  }

  button {
    display: flex;
    align-items: center;
    justify-content: center;
    transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;
    outline: 0;
    user-select: none;
    box-sizing: border-box;
    border-radius: $button-corner;
    cursor: pointer;
    border: none;
    width: 100%;
    position: relative;
    font-family: $font-family-base;
    line-height: $line-height-base;
    [icon] {
      margin-right: $gutter-small;
    }
    [icon][child-host=#{$jnt-icon-host}] {
      line-height: 0;
    }
    [text] {
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [badge] {
      margin-left: $gutter-small;
    }

    [loading] {
      position: absolute;
    }
  }
}


