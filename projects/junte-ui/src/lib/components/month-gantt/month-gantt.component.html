<table gantt border="0" cellpadding="5" [cellSpacing]="0">
  <tr>
    <td empty></td>
    <td controls [attr.colspan]="getDaysInMonth(current)">
      <div>
        <button arrow (click)="current = subMonths(current, 1)">
          <jnt-icon [icon]="ui.icons.arrowLeft"></jnt-icon>
        </button>
        <div month>
          {{current | format: 'MMMM'}}, {{current | format: 'YYYY'}}
        </div>
        <button arrow (click)="current = addMonths(current, 1)">
          <jnt-icon [icon]="ui.icons.arrowRight"></jnt-icon>
        </button>
      </div>
    </td>
  </tr>
  <tr>
    <td></td>
    <td day [attr.current]="day === getDate(today) && isSameMonth(current, today)"
        *ngFor="let day of getDaysInMonth(current) | numberArray:1">
      {{day}}
    </td>
  </tr>
  <tr *ngFor="let line of lines;let i = index">
    <ng-template #no_request>
      <td *ngFor="let day of getDaysInMonth(current) | numberArray:1"></td>
    </ng-template>

    <td title>{{line.title}}</td>

    <ng-container *ngIf="(line.data.from | same: current) || (line.data.to | same: current); else no_request">

      <td *ngFor="let day of (line.data.from | before: current) - 1 | numberArray"></td>

      <td [attr.colspan]="(line.data.to | after: current) - (line.data.from | before: current) + 1">
        <div [attr.accepting]="line.data.status === statuses.accepting"
             [attr.accepted]="line.data.status === statuses.accepted"
             [attr.declined]="line.data.status === statuses.declined"
             [attr.used]="(line.data.to | dateDiff:today) < 0"
             [attr.self-expense]="line.data.selfExpense"
             [attr.short]="(line.data.to | after: current) - (line.data.from | before: current) < 3"
             [attr.over-from]="(line.data.from | fullMonth) < (current | fullMonth)"
             [attr.over-to]="(line.data.to | fullMonth) > (current | fullMonth)" period>
          <span label>
            {{(line.data.to | dateDiff:line.data.from) + 1 }} days
          </span>
        </div>
      </td>

      <td *ngFor="let day of (getDaysInMonth(current) - (line.data.to | after: current)) | numberArray"></td>

    </ng-container>
  </tr>
</table>

<ng-container *ngIf="!lines?.length">
  <ng-container *ngIf="loading;else no_data">
    <tr loading>
      <td [attr.colspan]="getDaysInMonth(current) | numberArray:1">
        <jnt-skeleton [lines]="3"></jnt-skeleton>
      </td>
    </tr>
  </ng-container>
  <ng-template #no_data>
    <tr nodata>
      <td [attr.colspan]="getDaysInMonth(current) | numberArray:1">
        <jnt-icon [icon]="ui.icons.stopping" icon></jnt-icon>
      </td>
    </tr>
  </ng-template>
</ng-container>
